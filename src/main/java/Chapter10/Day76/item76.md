# 가능한 한 실패 원자적으로 만들라

실패 원자성 : 호출된 메서드가 실패하더라도, 해당 객체는 메서드 호출 전 상태를 유지해야한다.

## 실패 원자적으로 만드는 방법
 1. 불변 객체
 1. 가변 객체의 처리
    1. 작업 수행에 앞서 유효성 검사를 실행하는 방법. (내부 상태를 변경하기 전에 잠재적 예외상황을 걸러낸다.)
    1. 실패할 가능성이 있는 코드를 객체의 상태를 바꾸는 코드보다 앞에 배치하는 방법.
 1. 임시 복사본에서 작업을 수행 후, 성공적으로 완료되면 원본 객체와 교체.
    1. 리스트의 정렬에서는 배열에 옮겨담은 다음 정렬 실행 후 다시 리스트로 가져온다.
    1. 배열이 원소의 접근이 더 좋아서 더 빨라서 선택한 방법이지만, 실패 원자적인 특성도 가지게 되었다.
    1. 이처럼, 데이터를 임시 자료구조에 옮겨 작업하는 것이 더 빠를 때 쓰면 좋다.
    
    
## 실패 원자성은 항상 달성할 수 만은 없다.
 - 멀티스레딩 환경에서 동기화 없이 접근하면 객체의 일관성이 깨질 수 있다.
 - 따라서 예외를 잡아냈다고 해도 객체를 사용 가능한 상태에 있다고 가정하면 안된다.

## 실패 원자성은 무조건 달성해야하는 것은 아니다.
 - 실패 원자성을 달성하기 위한 비용이 아주 클 수 있다.
 - 그러나 보통의 경우에는 생각을 조금만 하면 위의 경우들 처럼 공짜로 실패원자성을 얻을 수 있다.